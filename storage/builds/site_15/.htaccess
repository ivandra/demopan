RewriteEngine On
RewriteBase /

# --- Universal: map /yandex_*.html on any subdomain to /subs/<sub>/yandex_*.html ---
# host: sub.example.tld  -> sub=%1, root=%2
RewriteCond %{HTTP_HOST} ^([a-z0-9-]+)\.(.+)$ [NC]
RewriteCond %{REQUEST_URI} ^/(yandex_[a-z0-9_]+\.html)$ [NC]

# не трогаем, если файл реально есть в корне сайта
RewriteCond %{DOCUMENT_ROOT}/%1 [!-f]

# но если файл есть в subs/<sub>/ — отдаем его
RewriteCond %{DOCUMENT_ROOT}/subs/%1/%1 -f

RewriteRule ^(yandex_[a-z0-9_]+\.html)$ subs/%1/$1 [L,NC]

# index.php -> /
RewriteCond %{THE_REQUEST} \s/+(.*/)?index\.php[\s?] [NC]
RewriteRule ^(.*/)?index\.php$ https://%{HTTP_HOST}/%1 [R=301,L]

RewriteRule ^(.*)index\.html$ https://%{HTTP_HOST}/$1 [R=301,L]
RewriteRule ^(.*)index\.htm$  https://%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule ^(.*)$ https://%1/$1 [L,R=301]

RewriteRule ^sitemap\.xml$ sitemap.php [L]
RewriteRule ^robots\.txt$  robots.php [L]

RewriteCond %{THE_REQUEST} //
RewriteCond %{QUERY_STRING} !http(s|)://
RewriteRule .* https://%{HTTP_HOST}/$0 [R=301,L]

# PROMOLINK (/reg и /reg/*) -> index.php (guard.php обработает)
RewriteRule ^reg(?:/.*)?$ index.php [L,QSA]

RewriteCond %{HTTP_HOST} ^(www\.)?mostbet99\.casino$ [NC]
RewriteRule ^ https://mostbet991.casino%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} ^(www\.)?mostbet990\.casino$ [NC]
RewriteRule ^ https://mostbet991.casino%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} ^(www\.)?mostbet991\.casino$ [NC]
RewriteRule ^ https://mostbet992.casino%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} ^(www\.)?mostbet992\.casino$ [NC]
RewriteRule ^ https://mostbet993.casino%{REQUEST_URI} [R=301,L]

# Главный роутер
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+?)/?$ index.php [L,QSA]

